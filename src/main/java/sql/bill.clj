(ns sql.bill
  (:use [com.rps.util.dao.cljutil.daoutil2] )
  (:import [javax.servlet.http HttpServletRequest]
           [com.rps.util.dao SqlAndParams]
           [java.util ArrayList]))

(defsql pageBill {
    :sql "select * from t_b_bill "
    :where (AND 
        ("start_time"  "create_time >= str_to_date(?,'%Y-%m-%d %H:%i:%s') ")
        ("end_time"  "create_time <= str_to_date(?,'%Y-%m-%d %H:%i:%s')")
        ("bill_amount_start"  "bill_amount >= ?")
        ("bill_amount_end"  "bill_amount <= ?")
        ("user_name"  "user_name like ?" "%" "%")
        ("bill_status"  "bill_status = ?")
        ("bill_type"  "bill_type = ?")
        ("department_id"  "department_id = ?")
        ("subject_id"  "subject_id = ?")
        {"orgIdList"  "org_id in @orgIdList"}
        {"check_status_not_in"  "check_status != ?"}
        {"user_id"  "bill_id in (select bill_id from t_b_bill_check where auditor_id = ? and check_status != '4')"}
        {"org_id"  "corp_id = ?"}
     )
    :page true
    :orderby true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
    :orderby-default " order by bill_id desc"
})

(defsql pageBillCheck {
    :sql "select * from t_b_bill_check "
    :where (AND 
        ("bill_id"  "bill_id = ?")
;        {"sort_id_not_equal"  "sort_id != ?"}
     )
    :page true
    :orderby true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
    :orderby-default " order by sort_id asc"
})

(defsql pageBorrowType {
    :sql "select * from t_b_borrow_type "
    :where (AND 
         ("borrow_type_name"  "borrow_type_name like ?" "%" "%")
         ("borrow_type_status"  "borrow_type_status = ?")
     )
    :page true
    :orderby true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
    :orderby-default " order by borrow_type_name asc"
})
